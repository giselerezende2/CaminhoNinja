<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/janela.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>


    <link rel="stylesheet" href="./../css/dashboards.css">
    <link rel="stylesheet" href="./../css/estilo.css" />
    <script src="../js/sessao.js"></script>
    <script src="./../js/alerta.js"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<!-- <body onload=" atualizarFeed()"> -->

<body class="manga">
    >
    <div class="janela">
        <div class="header-left">
            <img src="../assets/imgs/LOGO__2_-removebg-preview.png" style="width: 200px;" alt="">
            <!-- <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div> -->
            <div class="btn-nav-white">
                <a href="./cards.html">
                    <h3>Classificação</h3>
                </a>
            </div>
            <div class="btn-nav">
                <h3>Quiz</h3>
            </div>
            <div class="btn-nav-white">
                <a href="./mural.html">
                    <h3>Fórum</h3>
                </a>
            </div>
            <div class="btn-logout" onclick="limparSessao()">
                <h3>Sair</h3>
            </div>
        </div>
    </div>

    <div id="divmensagem">
        <div class="entrada">
            <div class="entrada-box" onclick="redirectToQuiz()">
                <h3>Quiz #01</h3>
                <p>Teste seus conhecimentos sobre os personagens.</p>
            </div>
            <div class="entrada-box2" onclick="direcionarToQuiz()">
                <h3 style="color: white;">Quiz #02</h3>
                <p>Teste seus conhecimentos sobre os lugares.</p>
            </div>
        </div>
    </div>
    <!-- <div class="container-quiz1" id="container-quiz1" style="display: none;"> -->
    <div id="div_mensagem1" style="display: none;" class="card-questao">
        <!-- <div id="div_mensagem1" class="card-questao"> -->
        <h3 id="numQuestao">Questão 1</h3>
        <h4>QUAL É O PERSONAGEM?</h4>
        <img class="ninja" src="../assets/imgs/ninja1.jpg" alt=""><br>
        <label>
            <input type="radio" name="questao" value="rock lee">
            <span class="alternativas">Rock lee</span>
        </label> <br>
        <label>
            <input type="radio" name="questao" value="shikamaru">
            <span  class="alternativas">Shikamaru</span>
        </label> <br>
        <label>
            <input type="radio" name="questao" value="sasuke">
            <span class="alternativas">Sasuke</span>
        </label> <br>
        <label>
            <input type="radio" name="questao" value="gaara">
            <span  class="alternativas">Gaara</span>
        </label>
        <br>

        <button onclick="analisar()">Próxima</button>
    </div>

    <div id="div_final" class="result">
        <h2>Parabéns! Você completou o quiz.</h2>
        <div class="score" id="score"></div>
        <img class="naruto-final" src="../assets/imgs/natuto_inicio.png" alt="">
        <button class="botao-voltar" onclick="voltar()">Voltar</button>
        <div class="chart">
            <canvas id="myChart"></canvas>
        </div>
    </div>



    <div class="container-quiz2" id="container-quiz2" style="display: flex; ">
        <div id="div_mensagem1_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 1</h3>
            <h4>QUAL É O NOME DA VILA OCULTA ONDE NARUTO UZUMAKI E SEUS AMIGOS VIVEM?</h4><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a1_2" name="1">A) Vila da Folha<br>
            <input type="radio" id="input_b1_2" name="1">B) Vila da Areia<br>
            <input type="radio" id="input_c1_2" name="1">C) Vila da Nuvem<br>
            <input type="radio" id="input_d1_2" name="1">D) Vila da Pedra<br><br>
            <button onclick="observar()">Próxima</button>
        </div>
        <div id="div_mensagem2_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 2</h3>
            <h4>ONDE OCORRE A BATALHA FINAL ENTRE NARUTO E SASUKE NO FINAL DA PARTE I DA SÉRIE?</h4><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a2_2" name="2">A) Floresta da Morte<br>
            <input type="radio" id="input_b2_2" name="2">B) Monte Myoboku<br>
            <input type="radio" id="input_c2_2" name="2">C) Vale do Fim<br>
            <input type="radio" id="input_d2_2" name="2">D) Caverna Ryuchi<br><br>
            <button onclick="observar1()">Próxima</button>
        </div>
        <div id="div_mensagem3_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 3</h3>
            <h4>QUAL É O NOME DO LOCAL ONDE OROCHIMARU REALIZA SEUS EXPERIMENTOS?</h4><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a3_2" name="3">A) Vila da Areia<br>
            <input type="radio" id="input_b3_2" name="3">B) Monte Myoboku<br>
            <input type="radio" id="input_c3_2" name="3">C) Caverna RYuchi <br>
            <input type="radio" id="input_d3_2" name="3">D) Vale do Fim<br><br>
            <button onclick="observar2()">Próxima</button>
        </div>
        <div id="div_mensagem4_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 4</h3>
            <h4>QUAL É O NOME DO LOCAL ONDE OCORRE O EXAME CHUNIN?</h4><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a4_2" name="4">A) Vale do Fim<br>
            <input type="radio" id="input_b4_2" name="4">B) Campo de Treinamento<br>
            <input type="radio" id="input_c4_2" name="4">C) Vila da Areia<br>
            <input type="radio" id="input_d4_2" name="4">D) Torre de Exames<br><br>
            <button onclick="observar3()">Próxima</button>
        </div>
        <div id="div_mensagem5_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 5</h3>
            <h4>QUAL É O NOME DO LOCAL ONDE NARUTO APRENDE A TÉCNICA DO MODO SÁBIO COM OS SAPOS SÁBIOS?</h4><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a5_2" name="5">A) Caverna Ryuchi<br>
            <input type="radio" id="input_b5_2" name="5">B) Monte Myoboku<br>
            <input type="radio" id="input_c5_2" name="5">C) País do Fogo<br>
            <input type="radio" id="input_d5_2" name="5">D) Vila da Chuva<br><br>
            <button onclick="encerrar()">Finalizar</button>
        </div>

        <div id="div_final2" class="result">
            <h2>Parabéns! Você completou o quiz.</h2>
            <div class="score" id="score2"></div>
            <img class="naruto-final" src="../assets/imgs/natuto_inicio.png" alt="">
            <button class="botao-voltar" onclick="voltar2()">Voltar</button>
        </div>
    </div>
</body>

</html>

<script>
    // QUIZ 1

    // b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    var fkUsuarioVar = sessionStorage.ID_USUARIO;
    var acertosVar = 0;
    var errosVar = 0;

    var questoes = [
        {
            numQuestao: 'Questão 1',
            imagem: '../assets/imgs/ninja1.jpg',
            alternativas: ['Rock lee', 'Shikamaru', 'Sasuke', 'Gaara']
        },
        {
            numQuestao: 'Questão 2',
            imagem: '../assets/imgs/ninja2.jpeg',
            alternativas: ['Minato', 'Nagato', 'Kakashi', 'Itachi']
        },
        {
            numQuestao: 'Questão 3',
            imagem: '../assets/imgs/ninja3.jpeg',
            alternativas: ['Temari', 'Rim', 'Sakura', 'Tsunade']
        },
        {
            numQuestao: 'Questão 4',
            imagem: '../assets/imgs/ninja4.jpeg',
            alternativas: ['Neji', 'Madara', 'Tobirama', 'Hashirama']
        },
        {
            numQuestao: 'Questão 5',
            imagem: '../assets/imgs/ninja5.jpeg',
            alternativas: ['Ino', 'Tenten', 'Konan', 'Hinata']
        }
    ];

    var respostas = ['Rock lee', 'Kakashi', 'Rim', 'Hashirama', 'Konan'];
    var pergunta_atual = 0;
    var acertosVar = 0;

    function armazenarResultados(id) {
        fetch("/usuarios/encerrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js

                acertosServer: acertosVar,
                errosServer: errosVar,
                fkUsuarioServer: fkUsuarioVar,
                fkQuizServer: id
            }),
        }).then(response => response.json())
            .then(data => {
                console.log('Success:', data);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
    }

    function redirectToQuiz() {
        document.getElementById('divmensagem').style.display = "none"
        document.getElementById('div_mensagem1').style.display = "block"

    }


    function analisar() {
        var alternativas = document.getElementsByName('questao'); // armazena todos os elementos de input com o atributo name='questao'
        var selecionado; // armazena o valor da alternativa selecionada.
        for (var index = 0; index < alternativas.length; index++) { // percorre todas as alternativas e verifica qual delas está selecionada 
            if (alternativas[index].checked) {
                selecionado = alternativas[index].value;
            }
        }

        if (selecionado == respostas[pergunta_atual]) { // verifica se a alternativa selecionada é igual à resposta correta armazenada na lista_respostas
            acertosVar++;
        }

        pergunta_atual++;

        if (pergunta_atual < questoes.length) {
        document.getElementById('numQuestao').textContent = questoes[pergunta_atual].numQuestao; // atualiza o texto do elemento com id numQuestao 
        document.querySelector('.ninja').src = questoes[pergunta_atual].imagem; // Atualiza a imagem mostrada
     
        for (var index = 0; index < alternativas.length; index++) { // irá percorrer através de todas as alternativas d
            alternativas[index].value = questoes[pergunta_atual].alternativas[index]; // define o valor da alternativa para a nova pergunta.
            alternativas[index].nextElementSibling.textContent = questoes[pergunta_atual].alternativas[index]; // atualiza o texto associado a nova alternativa.
            alternativas[index].checked = false;
        }

        } else {// se não houver mais pergunta
            document.getElementById('div_mensagem1').style.display = "none";
            document.getElementById('div_final').style.display = "block";
            armazenarResultados(1);
            exibirResultados();
        }
    }
    function exibirResultados() {
        var score = document.getElementById('score');
        score.innerText = `Você acertou ${acertosVar} de 5 questões!`;

        const criarGrafico = ( acertos, erros) => {
            new Chart(ctx, {
                type: tipo,
                data: {
                    labels: ["Acertos", "Erros"],
                    datasets: [{
                        data: [acertosVar, errosVar],
                        backgroundColor: ["rgba(39, 163, 0, 0.4)", "rgba(186, 12, 12, 0.4)"],
                        borderColor: ["rgb(39, 163, 0)", "rgb(186, 12, 12)"],
                        borderWidth: 2,
                    }],
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                        },
                    },
                },
            });
        };
    }

    function voltar() {
        window.location.href = 'cards.html';
    }


    // QUIZ 2 
    function direcionarToQuiz() {
        document.getElementById('divmensagem').style.display = "none"
        document.getElementById('div_mensagem1_quiz2').style.display = "block"
        document.getElementById('container-quiz2').style.display = "block"
    }
    function observar() {
        var alternativa1 = document.getElementById('input_a1_2').checked;
        if (alternativa1) {
            acertosVar++
        } else { 
            errosVar++
        }
        document.getElementById('div_mensagem1_quiz2').style.display = "none"
        document.getElementById('div_mensagem2_quiz2').style.display = "block"
    }

    function observar1() {
        var alternativa2 = document.getElementById('input_c2_2').checked;
        if (alternativa2) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem2_quiz2').style.display = "none"
        document.getElementById('div_mensagem3_quiz2').style.display = "block"
    }
    function observar2() {
        var alternativa3 = document.getElementById('input_c3_2').checked;
        if (alternativa3) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem3_quiz2').style.display = "none"
        document.getElementById('div_mensagem4_quiz2').style.display = "block"
    }
    function observar3() {
        var alternativa4 = document.getElementById('input_d4_2').checked;
        if (alternativa4) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem4_quiz2').style.display = "none"
        document.getElementById('div_mensagem5_quiz2').style.display = "block"
    }
    function encerrar() {
        var alternativa5 = document.getElementById('input_b5_2').checked;
        if (alternativa5) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem5_quiz2').style.display = "none"
        document.getElementById('div_final2').style.display = "block"

        armazenarResultados(2);
        exibirPontuacao();
    }

    function exibirPontuacao() {
        var score = document.getElementById('score2');
        score2.innerText = `Você acertou ${acertosVar} de 5 questões!`;
    }

    function voltar2() {
        window.location.href = 'cards.html';
    }

</script>