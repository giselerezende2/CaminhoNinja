<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/janela.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>


    <link rel="stylesheet" href="./../css/dashboards.css">
    <link rel="stylesheet" href="./../css/estilo.css" />
    <script src="../js/sessao.js"></script>
    <script src="./../js/alerta.js"></script>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<!-- <body onload=" atualizarFeed()"> -->

<body class="sem-img">
    >
    <div class="janela">
        <div class="header-left">
            <img src="../assets/imgs/LOGO__2_-removebg-preview.png" style="width: 200px;" alt="">
            <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>
            <div class="btn-nav-white">
                <a href="./cards.html">
                    <h3>Classificação</h3>
                </a>
            </div>
            <div class="btn-nav">
                <h3>Quiz</h3>
            </div>
            <div class="btn-nav-white">
                <a href="./mural.html">
                    <h3>Fórum</h3>
                </a>
            </div>
            <div class="btn-logout" onclick="limparSessao()">
                <h3>Sair</h3>
            </div>
        </div>
    </div>

    <div id="divmensagem">
        <div class="entrada">
            <div class="entrada-box" onclick="redirectToQuiz()">
                <h3>Quiz #01</h3>
                <p>Teste seus conhecimentos sobre os personagens.</p>
            </div>
            <div class="entrada-box2" onclick="direcionarToQuiz()">
                <h3 style="color: white;">Quiz #02</h3>
                <p>Teste seus conhecimentos sobre os lugares.</p>
            </div>
        </div>
    </div>
    <div class="container-quiz1" id="container-quiz1" style="display: none;">
        <div id="div_mensagem1" style="display: none;" class="card-questao">
            <h3>Questão 1</h3>
            <h5>Qual o nome do personagem?</h5>
            <img class="ninja" src="../assets/imgs/ninja1.jpg" alt=""><br>
            <input type="radio" id="input_a1" name="1">A) Rock Lee<br>
            <input type="radio" id="input_b1" name="1">B) Shikamaru<br>
            <input type="radio" id="input_c1" name="1">C) Sasuke<br>
            <input type="radio" id="input_d1" name="1">D) Gaara<br><br>
            <button onclick="analisar()">Próxima</button>
        </div>
        <div id="div_mensagem2" style="display: none;" class="card-questao">
            <h3>Questão 2</h3>
            <h5>Qual o nome do personagem?</h5>
            <img class="ninja" src="../assets/imgs/ninja2.jpeg" alt=""><br>
            <input type="radio" id="input_a2" name="2">A) Minato<br>
            <input type="radio" id="input_b2" name="2">B) Nagato<br>
            <input type="radio" id="input_c2" name="2">C) Kakashi<br>
            <input type="radio" id="input_d2" name="2">D) Itachi<br><br>
            <button onclick="analisar1()">Próxima</button>
        </div>
        <div id="div_mensagem3" style="display: none;" class="card-questao">
            <h3>Questão 3</h3>
            <h5>Qual o nome do personagem?</h5>
            <img class="ninja" src="../assets/imgs/ninja3.jpeg" alt=""><br>
            <input type="radio" id="input_a3" name="3">A) Temari<br>
            <input type="radio" id="input_b3" name="3">B) Rim<br>
            <input type="radio" id="input_c3" name="3">C) Sakura <br>
            <input type="radio" id="input_d3" name="3">D) Tsunade<br><br>
            <button onclick="analisar2()">Próxima</button>
        </div>
        <div id="div_mensagem4" style="display: none;" class="card-questao">
            <h3>Questão 4</h3>
            <h5>Qual o nome do personagem?</h5>
            <img class="ninja" src="../assets/imgs/ninja4.jpeg" alt=""><br>
            <input type="radio" id="input_a4" name="4">A) Neji<br>
            <input type="radio" id="input_b4" name="4">B) Madara<br>
            <input type="radio" id="input_c4" name="4">C) Tobirama<br>
            <input type="radio" id="input_d4" name="4">D) Hashirama<br><br>
            <button onclick="analisar3()">Próxima</button>
        </div>
        <div id="div_mensagem5" style="display: none;" class="card-questao">
            <h3>Questão 5</h3>
            <h5>Qual o nome do personagem?</h5>
            <img class="ninja" src="../assets/imgs/ninja5.jpeg" alt=""><br>
            <input type="radio" id="input_a5" name="5">A) Ino<br>
            <input type="radio" id="input_b5" name="5">B) Tenten<br>
            <input type="radio" id="input_c5" name="5">C) Konan<br>
            <input type="radio" id="input_d5" name="5">D) Hinata<br><br>
            <button onclick="finalizar()">Finalizar</button>
        </div>

        <div id="div_final" class="result">
            <h2>Parabéns! Você completou o quiz.</h2>
            <div class="score" id="score"></div>
            <img class="naruto-final" src="../assets/imgs/natuto_inicio.png" alt="">
            <button class="botao-voltar" onclick="voltar()">Voltar</button>
        </div>
    </div>


    <div class="container-quiz2" id="container-quiz2" style="display: flex; ">
        <div id="div_mensagem1_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 1</h3>
            <h5>Qual é o nome da vila oculta onde Naruto Uzumaki e seus amigos vivem?</h5><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a1_2" name="1">A) Vila da Folha<br>
            <input type="radio" id="input_b1_2" name="1">B) Vila da Areia<br>
            <input type="radio" id="input_c1_2" name="1">C) Vila da Nuvem<br>
            <input type="radio" id="input_d1_2" name="1">D) Vila da Pedra<br><br>
            <button onclick="observar()">Próxima</button>
        </div>
        <div id="div_mensagem2_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 2</h3>
            <h5>Onde ocorre a batalha final entre Naruto e Sasuke no final da Parte I da série?</h5><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a2_2" name="2">A) Floresta da Morte<br>
            <input type="radio" id="input_b2_2" name="2">B) Monte Myoboku<br>
            <input type="radio" id="input_c2_2" name="2">C) Vale do Fim<br>
            <input type="radio" id="input_d2_2" name="2">D) Caverna Ryuchi<br><br>
            <button onclick="observar1()">Próxima</button>
        </div>
        <div id="div_mensagem3_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 3</h3>
            <h5>Qual é o nome do local onde Orochimaru realiza seus experimentos?</h5><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a3_2" name="3">A) Vila da Areia<br>
            <input type="radio" id="input_b3_2" name="3">B) Monte Myoboku<br>
            <input type="radio" id="input_c3_2" name="3">C) Caverna RYuchi <br>
            <input type="radio" id="input_d3_2" name="3">D) Vale do Fim<br><br>
            <button onclick="observar2()">Próxima</button>
        </div>
        <div id="div_mensagem4_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 4</h3>
            <h5>Qual é o nome do local onde ocorre o Exame Chunin?</h5><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a4_2" name="4">A) Vale do Fim<br>
            <input type="radio" id="input_b4_2" name="4">B) Campo de Treinamento<br>
            <input type="radio" id="input_c4_2" name="4">C) Vila da Areia<br>
            <input type="radio" id="input_d4_2" name="4">D) Torre de Exames<br><br>
            <button onclick="observar3()">Próxima</button>
        </div>
        <div id="div_mensagem5_quiz2" style="display: none;" class="card-questao">
            <h3>Questão 5</h3>
            <h5>Qual é o nome do local onde Naruto aprende a técnica do Modo Sábio com os sapos sábios?</h5><br>
            <img class="vila" src="../assets/imgs/vila.jpg" alt=""><br>
            <input type="radio" id="input_a5_2" name="5">A) Caverna Ryuchi<br>
            <input type="radio" id="input_b5_2" name="5">B) Monte Myoboku<br>
            <input type="radio" id="input_c5_2" name="5">C) País do Fogo<br>
            <input type="radio" id="input_d5_2" name="5">D) Vila da Chuva<br><br>
            <button onclick="encerrar()">Finalizar</button>
        </div>

        <div id="div_final" class="result">
            <h2>Parabéns! Você completou o quiz.</h2>
            <div class="score" id="score"></div>
            <img class="naruto-final" src="../assets/imgs/natuto_inicio.png" alt="">
            <button class="botao-voltar" onclick="voltar()">Voltar</button>
        </div>
    </div>
</body>

</html>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    var fkUsuarioVar = sessionStorage.ID_USUARIO;
    var acertosVar = 0;
    var errosVar = 0;

      
    function armazenarResultados(id) {
        fetch("/usuarios/encerrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js

                acertosServer: acertosVar,
                errosServer: errosVar,
                fkUsuarioServer: fkUsuarioVar,
                fkQuizServer: id
            }),
        }).then(function (armazenarResultados) {
            const ctx = document.getElementById('resultadosGrafico').getContext('2d');
            const quizChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Respostas Corretas', 'Respostas Incorretas'],
                    datasets: [{
                        label: 'Quantidade',
                        data: [acertosVar, errosVar],
                        backgroundColor: [
                            'rgba(0, 128, 0, 0.5)',
                            'rgba(255, 0, 0, 0.5)',
                        ],
                        borderColor: [
                            'rgba(0, 128, 0, 1)',
                            'rgba(255, 0, 0, 1)',
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.raw;
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        })

    }

    function redirectToQuiz() {
        document.getElementById('divmensagem').style.display = "none"
        document.getElementById('div_mensagem1').style.display = "block"
        document.getElementById('container-quiz1').style.display = "block"


    }

    function analisar() {
        var alternativa1 = document.getElementById('input_a1').checked;
        if (alternativa1) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem1').style.display = "none"
        document.getElementById('div_mensagem2').style.display = "block"

    }

    function analisar1() {
        var alternativa2 = document.getElementById('input_c2').checked;
        if (alternativa2) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem2').style.display = "none"
        document.getElementById('div_mensagem3').style.display = "block"
    }
    function analisar2() {
        var alternativa3 = document.getElementById('input_b3').checked;
        if (alternativa3) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem3').style.display = "none"
        document.getElementById('div_mensagem4').style.display = "block"
    }
    function analisar3() {
        var alternativa4 = document.getElementById('input_d4').checked;
        if (alternativa4) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem4').style.display = "none"
        document.getElementById('div_mensagem5').style.display = "block"
    }
    function finalizar() {
        var alternativa5 = document.getElementById('input_c5').checked;
        if (alternativa5) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem5').style.display = "none"
        document.getElementById('div_final').style.display = "block"

        armazenarResultados(1);
        exibirResultados(1);
       
    } function exibirResultados(id) {
            var score = document.getElementById('score');
            score.innerText = `Você acertou ${acertosVar} de 5 questões!`;
        }

    function direcionarToQuiz() {
        document.getElementById('divmensagem').style.display = "none"
        document.getElementById('div_mensagem1_quiz2').style.display = "block"
        document.getElementById('container-quiz2').style.display = "block"
    }
    function observar() {
        var alternativa1 = document.getElementById('input_a1_2').checked;
        if (alternativa1) {
            acertosVar++
        } else {
            errosVar++
        }
        document.getElementById('div_mensagem1_quiz2').style.display = "none"
        document.getElementById('div_mensagem2_quiz2').style.display = "block"
    }

    function observar1() {
        var alternativa2 = document.getElementById('input_c2_2').checked;
        if (alternativa2) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem2_quiz2').style.display = "none"
        document.getElementById('div_mensagem3_quiz2').style.display = "block"
    }
    function observar2() {
        var alternativa3 = document.getElementById('input_c3_2').checked;
        if (alternativa3) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem3_quiz2').style.display = "none"
        document.getElementById('div_mensagem4_quiz2').style.display = "block"
    }
    function observar3() {
        var alternativa4 = document.getElementById('input_d4_2').checked;
        if (alternativa4) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem4_quiz2').style.display = "none"
        document.getElementById('div_mensagem5_quiz2').style.display = "block"
    }
    function encerrar() {
        var alternativa5 = document.getElementById('input_b5_2').checked;
        if (alternativa5) {
            acertosVar++
        } else {
            errosVar++
        }

        document.getElementById('div_mensagem5_quiz2').style.display = "none"
        document.getElementById('div_final_quiz2').style.display = "block"

        armazenarResultados(2);
        exibirResultados(1);
    }
    

    // function armazenarResultados() {
    //     fetch("/usuarios/encerrar", {
    //         method: "POST",
    //         headers: {
    //             "Content-Type": "application/json",
    //         },
    //         body: JSON.stringify({
    //             // crie um atributo que recebe o valor recuperado aqui
    //             // Agora vá para o arquivo routes/usuario.js

    //             acertosServer: acertosVar,
    //             errosServer: errosVar,
    //             fkUsuarioServer: fkUsuarioVar,
    //             fkQuizServer: 2
    //         }),
    //     }).then(function (armazenarResultados) {
    //         const ctx = document.getElementById('resultadosGrafico').getContext('2d');
    //         const quizChart = new Chart(ctx, {
    //             type: 'bar',
    //             data: {
    //                 labels: ['Respostas Corretas', 'Respostas Incorretas'],
    //                 datasets: [{
    //                     label: 'Quantidade',
    //                     data: [acertosVar, errosVar],
    //                     backgroundColor: [
    //                         'rgba(0, 128, 0, 0.5)',
    //                         'rgba(255, 0, 0, 0.5)',
    //                     ],
    //                     borderColor: [
    //                         'rgba(0, 128, 0, 1)',
    //                         'rgba(255, 0, 0, 1)',
    //                     ],
    //                     borderWidth: 1
    //                 }]
    //             },
    //             options: {
    //                 responsive: true,
    //                 plugins: {
    //                     legend: {
    //                         position: 'top',
    //                     },
    //                     tooltip: {
    //                         callbacks: {
    //                             label: function (context) {
    //                                 let label = context.label || '';
    //                                 if (label) {
    //                                     label += ': ';
    //                                 }
    //                                 label += context.raw;
    //                                 return label;
    //                             }
    //                         }
    //                     }
    //                 }
    //             }
    //         });
    //     })
    // }
</script>